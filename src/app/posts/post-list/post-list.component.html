<mat-spinner *ngIf="isLoading"></mat-spinner>
<mat-accordion multi="true" *ngIf="posts.length > 0 && !isLoading">
  <div class="post" *ngFor="let post of posts; let i = index">
    <div class="post__header">
      <strong class="post__header-user">{{ post.creator }}</strong>
      <div class="post__header-meta">
          <div>{{ post.created_at | date: 'MM/dd/yyyy' }}</div>
          <div>{{ post.created_at | date: 'h:mm aa' }}</div>
      </div>
    </div>
    <div class="post__content">  <!-- Post content section -->
      <span>
        {{ post.post }}
        <mat-action-row *ngIf="userIsAuthenticated && userId === post.creatorId">
          <button mat-button color="warn" (click)="onDelete(post.id)">Delete</button>
        </mat-action-row>
      </span>
    </div>  <!-- Post content section -->

    <mat-expansion-panel>  <!-- Comments list    *ngIf="post.comments.length > 0" -->
        <mat-expansion-panel-header>
            Comments
          </mat-expansion-panel-header>
          <div>
            <form [formGroup]="createCommentForm" role="comment form">
              <textarea
                matInput
                matTextareaAutosize
                matAutosizeMinRows=1
                matAutosizeMaxRows=5
                name="comment"
                aria-label="comment input"
                formControlName="comment"
                placeholder="Share a comment"
                class="enter-comment"></textarea>
              <mat-error *ngIf="createCommentForm.get('comment').invalid && (createCommentForm.get('comment').dirty || createCommentForm.get('comment').touched)">Comments field cannot be empty.</mat-error>

              <div class="forms__button-group" *ngIf="userIsAuthenticated && createCommentForm.get('comment').dirty">
                <button
                  [disabled]="!this.createCommentForm.valid"
                  mat-raised-button color="primary"
                  class="btn"
                  (click)="postComment(post.id)"
                  type="submit">Submit</button>
                <button
                [disabled]="!this.createCommentForm.valid"
                mat-raised-button
                color="accent"
                class="btn"
                (click)="cancelSubmit()"
                type="submit">Clear</button>
              </div>
            </form>
          </div>
      <ul class="comments">
        <li class="comments__item" *ngFor="let comment of post.comments; let i = index">
          <div class="comments__item-header">
            <strong class="comments__item-user">{{ comment.commentator }}</strong>
            <div class="comments__item-meta">
              <div>{{ comment.createdAt | date: 'MM/dd/yyyy' }}</div>
              <div>{{ comment.createdAt | date: 'h:mm aa' }}</div>
            </div>
          </div>
          <div class="comments__item-text">{{ comment.comment }}</div>
        </li>
      </ul>
    </mat-expansion-panel>  <!-- End Comments list -->

  </div>
</mat-accordion>
<mat-paginator [length]="totalPosts" [pageSize]="postsPerPage" [pageSizeOptions]="pageSizeOptions" (page)="onChangedPage($event)" *ngIf="posts.length > 0 && !isLoading"></mat-paginator>
<p class="info-text mat-body-1" *ngIf="posts.length <= 0 && !isLoading">No posts added yet</p>
